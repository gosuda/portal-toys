<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{.Title}} - ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€</title>
  <link rel="stylesheet" href="/static/style.css">
  <script>
    (function () {
      try {
        var params = new URLSearchParams(window.location.search);
        if (params.get("err") === "badpw") {
          alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¤ì„œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
          params.delete("err");
          var newUrl = window.location.pathname + (params.toString() ? "?" + params.toString() : "");
          window.history.replaceState({}, "", newUrl);
        }
      } catch (e) {
        // ignore
      }
    })();
  </script>
</head>
<body>
  <div class="dcwrap list_wrap">
    <header class="header-bar">
      <div>
        <div class="header-bar-title">ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ</div>
        <div class="header-bar-sub">ììœ ë¡­ê²Œ ê¸€ê³¼ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ëŠ” ê³µê°„ì…ë‹ˆë‹¤.</div>
      </div>
      <div class="header-bar-actions">
        <button type="button" class="btn-secondary" onclick="location.href='/'">&larr; ëª©ë¡ìœ¼ë¡œ</button>
        <button type="button" class="btn-primary" onclick="location.href='/write'">ìƒˆ ê¸€ ì“°ê¸°</button>
      </div>
    </header>

    <main class="view-wrap">
      <section class="left_content">
        <article>
          <div class="view-head">
            <div class="view-title">{{.Title}}</div>
            <div class="view-meta-row">
              <div class="view-meta-main">
                <span class="view-meta-author">{{if .Author}}{{.Author}}{{else}}anon{{end}}</span>
                <span class="view-meta-sep">Â·</span>
                <span class="view-meta-date">{{.CreatedAt.Format "2006-01-02 15:04:05"}}</span>
              </div>
              <form method="POST" action="/post/delete/{{.ID}}" class="post-delete-inline">
                <input type="password" name="password" class="post-delete-password" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="20">
                <button type="submit" class="btn-secondary btn-danger post-delete-btn">ì‚­ì œ</button>
              </form>
            </div>
          </div>

          <div class="view-body">
            <div class="view-body-content">{{- safeHTML .Body -}}</div>
            <div class="view-votes">
              <form method="POST" action="/post/vote/up/{{.ID}}" class="vote-form">
                <button type="submit" class="btn-vote btn-thumb">ğŸ‘ {{.Upvotes}}</button>
              </form>
              <form method="POST" action="/post/vote/down/{{.ID}}" class="vote-form">
                <button type="submit" class="btn-vote btn-unthumb">ğŸ‘ {{.Downvotes}}</button>
              </form>
            </div>
          </div>
        </article>

        <section class="comments-wrap">
          <h2>ëŒ“ê¸€</h2>
          {{if .Comments}}
            {{range .Comments}}
              <div class="comment-item">
                <div class="comment-meta">
                  <div class="comment-author">{{if .Author}}{{.Author}}{{else}}anon{{end}}</div>
                  <div class="comment-date">{{.CreatedAt.Format "01-02 15:04"}}</div>
                </div>
                <div class="comment-body">{{- .Body -}}</div>
                <div class="comment-actions">
                  <form method="POST" action="/post/comment/delete/{{$.ID}}/{{.ID}}" class="comment-delete-form">
                    <input type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="20">
                    <button type="submit" class="btn-secondary btn-danger btn-xs">ì‚­ì œ</button>
                  </form>
                </div>
              </div>
            {{end}}
          {{else}}
            <p class="empty">ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”.</p>
          {{end}}

          <div class="comment-form">
            <form method="POST" action="" class="comment-form-inline">
              <div class="comment-form-author">
                <input name="author" type="text" placeholder="ì‘ì„±ì (ê¸°ë³¸: anon)">
                <input name="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="20">
              </div>
              <div class="comment-form-body">
                <textarea name="body" rows="3" required placeholder="ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."></textarea>
              </div>
              <button type="submit" class="btn-primary comment-form-submit">ëŒ“ê¸€ ì“°ê¸°</button>
            </form>
          </div>
        </section>
      </section>
    </main>
  </div>
</body>
</html>
